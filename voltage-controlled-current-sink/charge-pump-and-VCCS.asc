Version 4
SHEET 1 880 1044
WIRE -3120 -160 -3120 -208
WIRE -2768 -160 -3120 -160
WIRE -2384 -160 -2768 -160
WIRE -3120 -112 -3120 -160
WIRE -224 -112 -224 -192
WIRE 176 -112 176 -160
WIRE 272 -112 272 -160
WIRE 688 -96 688 -144
WIRE -2752 -64 -2784 -64
WIRE -2784 -32 -2784 -64
WIRE -2784 -32 -2976 -32
WIRE -2752 -32 -2752 -64
WIRE -2656 -32 -2752 -32
WIRE -2384 -32 -2384 -160
WIRE -2384 -32 -2432 -32
WIRE 176 -16 176 -32
WIRE 272 -16 272 -32
WIRE -3104 0 -3136 0
WIRE -224 0 -224 -32
WIRE -3136 16 -3136 0
WIRE -3136 16 -3248 16
WIRE -3104 16 -3104 0
WIRE -2976 16 -2976 -32
WIRE -2976 16 -3104 16
WIRE -2768 16 -2768 -160
WIRE -2768 16 -2784 16
WIRE -2128 16 -2128 -16
WIRE -2080 16 -2128 16
WIRE -1920 16 -2016 16
WIRE -1888 16 -1920 16
WIRE -1776 16 -1776 -64
WIRE -1776 16 -1824 16
WIRE -1744 16 -1776 16
WIRE -1632 16 -1680 16
WIRE -1600 16 -1632 16
WIRE -1504 16 -1504 -64
WIRE -1504 16 -1536 16
WIRE -1440 16 -1504 16
WIRE -1328 16 -1376 16
WIRE -1280 16 -1328 16
WIRE -1184 16 -1184 -64
WIRE -1184 16 -1216 16
WIRE -1136 16 -1184 16
WIRE -1040 16 -1040 0
WIRE -1040 16 -1072 16
WIRE -1008 16 -1040 16
WIRE -896 16 -944 16
WIRE -784 16 -784 -80
WIRE -784 16 -896 16
WIRE -2656 32 -2864 32
WIRE -2784 48 -2784 16
WIRE -2768 48 -2784 48
WIRE -2864 80 -2864 32
WIRE -2864 80 -2880 80
WIRE -2768 80 -2768 48
WIRE -2768 80 -2784 80
WIRE -1920 80 -1920 16
WIRE -1776 80 -1776 16
WIRE -1632 80 -1632 16
WIRE -1504 80 -1504 16
WIRE -1328 80 -1328 16
WIRE -1184 80 -1184 16
WIRE -1040 80 -1040 16
WIRE -784 80 -784 16
WIRE 688 80 688 -16
WIRE -3120 96 -3120 -32
WIRE -2656 96 -3120 96
WIRE -2336 96 -2432 96
WIRE -896 96 -896 16
WIRE -2880 112 -2880 80
WIRE -2864 112 -2880 112
WIRE -2784 112 -2784 80
WIRE -2768 112 -2784 112
WIRE 416 128 416 96
WIRE -3120 144 -3120 96
WIRE 384 144 304 144
WIRE -3360 160 -3360 112
WIRE -2768 160 -2768 112
WIRE -2656 160 -2768 160
WIRE -2384 160 -2432 160
WIRE 496 160 448 160
WIRE 608 160 576 160
WIRE 640 160 608 160
WIRE -1616 176 -1648 176
WIRE -1312 176 -1344 176
WIRE -1024 176 -1056 176
WIRE -112 176 -176 176
WIRE 96 176 -32 176
WIRE 256 176 96 176
WIRE 384 176 256 176
WIRE -1776 192 -1776 144
WIRE -1648 192 -1648 176
WIRE -1648 192 -1776 192
WIRE -1616 192 -1616 176
WIRE -1504 192 -1504 144
WIRE -1504 192 -1616 192
WIRE -1344 192 -1344 176
WIRE -1344 192 -1504 192
WIRE -1312 192 -1312 176
WIRE -1200 192 -1200 176
WIRE -1200 192 -1312 192
WIRE -1184 192 -1184 144
WIRE -1184 192 -1200 192
WIRE -1168 192 -1168 176
WIRE -1168 192 -1184 192
WIRE -1056 192 -1056 176
WIRE -1056 192 -1168 192
WIRE -1024 192 -1024 176
WIRE -896 192 -896 160
WIRE -896 192 -1024 192
WIRE -784 192 -784 160
WIRE -784 192 -896 192
WIRE 608 192 608 160
WIRE -2384 224 -2384 160
WIRE -1776 224 -1776 192
WIRE 416 224 416 192
WIRE -3120 256 -3120 224
WIRE -2864 256 -2864 112
WIRE -2864 256 -3120 256
WIRE -3360 272 -3360 240
WIRE -2128 304 -2128 240
WIRE -1920 304 -1920 144
WIRE -1920 304 -2128 304
WIRE -1632 304 -1632 144
WIRE -1632 304 -1920 304
WIRE -1328 304 -1328 144
WIRE -1328 304 -1632 304
WIRE -1040 304 -1040 144
WIRE -1040 304 -1328 304
WIRE 304 304 304 144
WIRE 496 304 304 304
WIRE 688 304 688 176
WIRE 688 304 576 304
WIRE -3120 320 -3120 256
WIRE -2864 352 -2864 256
WIRE -2336 352 -2336 96
WIRE -2336 352 -2864 352
WIRE 96 352 96 176
WIRE 256 352 256 176
WIRE 688 384 688 304
WIRE -3120 432 -3120 384
WIRE 608 480 608 256
WIRE 608 480 592 480
WIRE 688 480 688 464
WIRE 688 480 608 480
WIRE -1616 496 -1616 448
WIRE 688 496 688 480
WIRE 96 512 96 416
WIRE 256 512 256 432
WIRE 256 512 96 512
WIRE 256 560 256 512
WIRE -1616 608 -1616 576
FLAG 416 224 0
FLAG 176 -16 0
FLAG 176 -160 Vsupply
FLAG 416 96 Vsupply
FLAG 272 -16 0
FLAG -176 176 Vcontrol
FLAG 256 560 0
FLAG -3120 -208 Vsupply
FLAG 688 496 0
FLAG -224 -192 Vcontrol
FLAG -224 0 0
FLAG 688 -144 Vsupply
FLAG -3120 432 0
FLAG -2384 224 0
FLAG -3360 272 0
FLAG -3360 112 Vocc
FLAG -3248 16 Vocc
FLAG -2128 -16 Vsupply
FLAG -1776 224 0
FLAG -784 -80 Vpump
FLAG -2128 240 PWM
FLAG -1616 608 0
FLAG -1616 448 PWM
FLAG -1776 -64 Vpump0
FLAG -1504 -64 Vpump1
FLAG -1184 -64 Vpump2
SYMBOL Opamps\\UniversalOpamp2 416 160 R0
SYMATTR InstName U1
SYMBOL voltage 176 -128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage 272 -128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res 592 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 672 368 R0
SYMATTR InstName R2
SYMATTR Value 2
SYMBOL res 672 -112 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL nmos 640 80 R0
SYMATTR InstName M1
SYMBOL res 592 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res 240 336 R0
SYMATTR InstName R5
SYMATTR Value 100
SYMBOL res -16 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL voltage -224 -128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 5 0 0 0 1m 2m 0)
SYMBOL cap 112 416 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C1
SYMATTR Value 100µ
SYMBOL cap 624 256 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL Misc\\NE555 -2544 64 R180
SYMATTR InstName U2
SYMBOL res -3136 -128 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL res -3136 128 R0
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL cap -3104 384 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C7
SYMATTR Value 1n5
SYMBOL voltage -3360 144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 10
SYMBOL schottky -2080 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -1904 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C8
SYMATTR Value 10µ
SYMBOL cap -1760 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C9
SYMATTR Value 10µ
SYMBOL cap -1616 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C10
SYMATTR Value 10µ
SYMBOL schottky -1888 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1744 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1600 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D6
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage -1616 480 R0
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 5 1
SYMATTR InstName V5
SYMATTR Value PULSE(0 5 0 {t_edge} {t_edge} {(duty/f)-t_edge} {1/f} 2k)
SYMBOL cap -880 160 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C3
SYMATTR Value 100µ
SYMBOL cap -1488 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C4
SYMATTR Value 10µ
SYMBOL schottky -1440 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1280 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -1312 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C5
SYMATTR Value 10µ
SYMBOL res -768 176 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL schottky -1136 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D7
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1008 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D8
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -1168 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C6
SYMATTR Value 10µ
SYMBOL cap -1024 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C11
SYMATTR Value 10µ
TEXT -2112 504 Left 2 !;dc V4 0 12 0.1
TEXT -2112 608 Left 2 !;step param duty 0.0 1.0 0.01
TEXT -2112 440 Left 2 !;.op
TEXT -2112 560 Left 2 !.tran 0 1 0 0.01
TEXT -1552 648 Left 2 !.param f=40k t_edge=1u duty=0.8
