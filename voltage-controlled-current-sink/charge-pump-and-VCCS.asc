Version 4
SHEET 1 880 1044
WIRE -224 -112 -224 -192
WIRE 176 -112 176 -160
WIRE 272 -112 272 -160
WIRE 688 -96 688 -144
WIRE -3888 -80 -3888 -128
WIRE -3536 -80 -3888 -80
WIRE -3152 -80 -3536 -80
WIRE -3888 -32 -3888 -80
WIRE 176 -16 176 -32
WIRE 272 -16 272 -32
WIRE -224 0 -224 -32
WIRE -3520 16 -3552 16
WIRE -1904 16 -1904 -16
WIRE -1856 16 -1904 16
WIRE -1696 16 -1792 16
WIRE -1664 16 -1696 16
WIRE -1552 16 -1552 -64
WIRE -1552 16 -1600 16
WIRE -1520 16 -1552 16
WIRE -1408 16 -1456 16
WIRE -1376 16 -1408 16
WIRE -1280 16 -1280 -64
WIRE -1280 16 -1312 16
WIRE -1216 16 -1280 16
WIRE -1104 16 -1152 16
WIRE -1056 16 -1104 16
WIRE -960 16 -960 -64
WIRE -960 16 -992 16
WIRE -912 16 -960 16
WIRE -816 16 -816 0
WIRE -816 16 -848 16
WIRE -784 16 -816 16
WIRE -672 16 -720 16
WIRE -560 16 -560 -80
WIRE -560 16 -672 16
WIRE -3552 48 -3552 16
WIRE -3552 48 -3744 48
WIRE -3520 48 -3520 16
WIRE -3424 48 -3520 48
WIRE -3152 48 -3152 -80
WIRE -3152 48 -3200 48
WIRE -3872 80 -3904 80
WIRE -1696 80 -1696 16
WIRE -1552 80 -1552 16
WIRE -1408 80 -1408 16
WIRE -1280 80 -1280 16
WIRE -1104 80 -1104 16
WIRE -960 80 -960 16
WIRE -816 80 -816 16
WIRE -560 80 -560 16
WIRE 688 80 688 -16
WIRE -3904 96 -3904 80
WIRE -3904 96 -4016 96
WIRE -3872 96 -3872 80
WIRE -3744 96 -3744 48
WIRE -3744 96 -3872 96
WIRE -3536 96 -3536 -80
WIRE -3536 96 -3552 96
WIRE -672 96 -672 16
WIRE -3424 112 -3632 112
WIRE -3552 128 -3552 96
WIRE -3536 128 -3552 128
WIRE 416 128 416 96
WIRE 384 144 304 144
WIRE -3632 160 -3632 112
WIRE -3632 160 -3648 160
WIRE -3536 160 -3536 128
WIRE -3536 160 -3552 160
WIRE 496 160 448 160
WIRE 608 160 576 160
WIRE 640 160 608 160
WIRE -3888 176 -3888 48
WIRE -3424 176 -3888 176
WIRE -3104 176 -3200 176
WIRE -1392 176 -1424 176
WIRE -1088 176 -1120 176
WIRE -800 176 -832 176
WIRE -112 176 -176 176
WIRE 96 176 -32 176
WIRE 256 176 96 176
WIRE 384 176 256 176
WIRE -3648 192 -3648 160
WIRE -3632 192 -3648 192
WIRE -3552 192 -3552 160
WIRE -3536 192 -3552 192
WIRE -1552 192 -1552 144
WIRE -1424 192 -1424 176
WIRE -1424 192 -1552 192
WIRE -1392 192 -1392 176
WIRE -1280 192 -1280 144
WIRE -1280 192 -1392 192
WIRE -1120 192 -1120 176
WIRE -1120 192 -1280 192
WIRE -1088 192 -1088 176
WIRE -960 192 -960 144
WIRE -960 192 -1088 192
WIRE -832 192 -832 176
WIRE -832 192 -960 192
WIRE -800 192 -800 176
WIRE -672 192 -672 160
WIRE -672 192 -800 192
WIRE -560 192 -560 160
WIRE -560 192 -672 192
WIRE 608 192 608 160
WIRE -3888 224 -3888 176
WIRE -1552 224 -1552 192
WIRE 416 224 416 192
WIRE -3536 240 -3536 192
WIRE -3424 240 -3536 240
WIRE -3152 240 -3200 240
WIRE -3152 304 -3152 240
WIRE -1904 304 -1904 224
WIRE -1872 304 -1904 304
WIRE -1696 304 -1696 144
WIRE -1696 304 -1792 304
WIRE -1408 304 -1408 144
WIRE -1408 304 -1696 304
WIRE -1104 304 -1104 144
WIRE -1104 304 -1408 304
WIRE -816 304 -816 144
WIRE -816 304 -1104 304
WIRE 304 304 304 144
WIRE 496 304 304 304
WIRE 688 304 688 176
WIRE 688 304 576 304
WIRE -3888 336 -3888 304
WIRE -3632 336 -3632 192
WIRE -3632 336 -3888 336
WIRE 96 352 96 176
WIRE 256 352 256 176
WIRE 688 384 688 304
WIRE -3888 400 -3888 336
WIRE -3632 432 -3632 336
WIRE -3104 432 -3104 176
WIRE -3104 432 -3632 432
WIRE 608 480 608 256
WIRE 608 480 592 480
WIRE 688 480 688 464
WIRE 688 480 608 480
WIRE -1392 496 -1392 448
WIRE 688 496 688 480
WIRE -3888 512 -3888 464
WIRE 96 512 96 416
WIRE 256 512 256 432
WIRE 256 512 96 512
WIRE -3760 544 -3760 496
WIRE 256 560 256 512
WIRE -1392 608 -1392 576
WIRE -3760 656 -3760 624
FLAG 416 224 0
FLAG 176 -16 0
FLAG 176 -160 Vsupply
FLAG 416 96 Vsupply
FLAG 272 -16 0
FLAG -176 176 Vcontrol
FLAG 256 560 0
FLAG -3888 -128 Vsupply
FLAG 688 496 0
FLAG -224 -192 Vcontrol
FLAG -224 0 0
FLAG 688 -144 Vsupply
FLAG -3888 512 0
FLAG -3152 304 0
FLAG -3760 656 0
FLAG -3760 496 Vocc
FLAG -4016 96 Vocc
FLAG -1904 -16 Vsupply
FLAG -1552 224 0
FLAG -560 -80 Vpump
FLAG -1904 224 PWM
FLAG -1392 608 0
FLAG -1392 448 PWM
FLAG -1552 -64 Vpump0
FLAG -1280 -64 Vpump1
FLAG -960 -64 Vpump2
SYMBOL Opamps\\UniversalOpamp2 416 160 R0
SYMATTR InstName U1
SYMBOL voltage 176 -128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage 272 -128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res 592 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 672 368 R0
SYMATTR InstName R2
SYMATTR Value 2
SYMBOL res 672 -112 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL nmos 640 80 R0
SYMATTR InstName M1
SYMBOL res 592 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res 240 336 R0
SYMATTR InstName R5
SYMATTR Value 100
SYMBOL res -16 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL voltage -224 -128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 5 0 0 0 1m 2m 0)
SYMBOL cap 112 416 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C1
SYMATTR Value 100µ
SYMBOL cap 624 256 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL Misc\\NE555 -3312 144 R180
SYMATTR InstName U2
SYMBOL res -3904 -48 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL res -3904 208 R0
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL cap -3872 464 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C7
SYMATTR Value 1n5
SYMBOL voltage -3760 528 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 10
SYMBOL schottky -1856 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -1680 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C8
SYMATTR Value 10µ
SYMBOL cap -1536 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C9
SYMATTR Value 10µ
SYMBOL cap -1392 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C10
SYMATTR Value 10µ
SYMBOL schottky -1664 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1520 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1376 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D6
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage -1392 480 R0
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 5 1
SYMATTR InstName V5
SYMATTR Value PULSE(0 5 0 {t_edge} {t_edge} {(duty/f)-t_edge} {1/f} 20k)
SYMBOL cap -656 160 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C3
SYMATTR Value 100µ
SYMBOL cap -1264 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C4
SYMATTR Value 10µ
SYMBOL schottky -1216 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1056 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -1088 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C5
SYMATTR Value 10µ
SYMBOL res -544 176 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL schottky -912 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D7
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -784 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D8
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -944 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C6
SYMATTR Value 10µ
SYMBOL cap -800 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C11
SYMATTR Value 10µ
SYMBOL res -1776 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
TEXT -1888 504 Left 2 !;dc V4 0 12 0.1
TEXT -1888 608 Left 2 !;step param duty 0.0 1.0 0.01
TEXT -1888 440 Left 2 !;.op
TEXT -1888 560 Left 2 !.tran 0 1 0 0.01
TEXT -1328 648 Left 2 !.param f=40k t_edge=1u duty=0.8
