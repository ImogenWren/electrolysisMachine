Version 4
SHEET 1 880 1044
WIRE -528 -96 -528 -176
WIRE -128 -96 -128 -144
WIRE -32 -96 -32 -144
WIRE 384 -80 384 -128
WIRE -1968 -64 -1968 -96
WIRE -1920 -64 -1968 -64
WIRE -1760 -64 -1856 -64
WIRE -1728 -64 -1760 -64
WIRE -1616 -64 -1664 -64
WIRE -1584 -64 -1616 -64
WIRE -1472 -64 -1520 -64
WIRE -1440 -64 -1472 -64
WIRE -1344 -64 -1376 -64
WIRE -1248 -64 -1344 -64
WIRE -1760 0 -1760 -64
WIRE -1616 0 -1616 -64
WIRE -1472 0 -1472 -64
WIRE -1344 0 -1344 -64
WIRE -128 0 -128 -16
WIRE -32 0 -32 -16
WIRE -528 16 -528 -16
WIRE -2864 32 -2864 -16
WIRE -2512 32 -2864 32
WIRE -2128 32 -2512 32
WIRE -2864 80 -2864 32
WIRE -1456 96 -1488 96
WIRE 384 96 384 0
WIRE -1616 112 -1616 64
WIRE -1488 112 -1488 96
WIRE -1488 112 -1616 112
WIRE -1456 112 -1456 96
WIRE -1344 112 -1344 64
WIRE -1344 112 -1456 112
WIRE -2496 128 -2528 128
WIRE -1616 144 -1616 112
WIRE 112 144 112 112
WIRE -2528 160 -2528 128
WIRE -2528 160 -2720 160
WIRE -2496 160 -2496 128
WIRE -2400 160 -2496 160
WIRE -2128 160 -2128 32
WIRE -2128 160 -2176 160
WIRE 80 160 0 160
WIRE 192 176 144 176
WIRE 304 176 272 176
WIRE 336 176 304 176
WIRE -2848 192 -2880 192
WIRE -416 192 -480 192
WIRE -208 192 -336 192
WIRE -48 192 -208 192
WIRE 80 192 -48 192
WIRE -2880 208 -2880 192
WIRE -2880 208 -2992 208
WIRE -2848 208 -2848 192
WIRE -2720 208 -2720 160
WIRE -2720 208 -2848 208
WIRE -2512 208 -2512 32
WIRE -2512 208 -2528 208
WIRE 304 208 304 176
WIRE -2400 224 -2608 224
WIRE -1968 224 -1968 160
WIRE -1760 224 -1760 64
WIRE -1760 224 -1968 224
WIRE -1472 224 -1472 64
WIRE -1472 224 -1760 224
WIRE -2528 240 -2528 208
WIRE -2512 240 -2528 240
WIRE 112 240 112 208
WIRE -2608 272 -2608 224
WIRE -2608 272 -2624 272
WIRE -2512 272 -2512 240
WIRE -2512 272 -2528 272
WIRE -2864 288 -2864 160
WIRE -2400 288 -2864 288
WIRE -2080 288 -2176 288
WIRE -3344 304 -3344 256
WIRE -2624 304 -2624 272
WIRE -2608 304 -2624 304
WIRE -2528 304 -2528 272
WIRE -2512 304 -2528 304
WIRE 0 320 0 160
WIRE 192 320 0 320
WIRE 384 320 384 192
WIRE 384 320 272 320
WIRE -2864 336 -2864 288
WIRE -2512 352 -2512 304
WIRE -2400 352 -2512 352
WIRE -2128 352 -2176 352
WIRE -208 368 -208 192
WIRE -48 368 -48 192
WIRE 384 400 384 320
WIRE -3344 416 -3344 384
WIRE -2128 416 -2128 352
WIRE -3712 448 -3712 400
WIRE -2864 448 -2864 416
WIRE -2608 448 -2608 304
WIRE -2608 448 -2864 448
WIRE 304 496 304 272
WIRE 304 496 288 496
WIRE 384 496 384 480
WIRE 384 496 304 496
WIRE -2864 512 -2864 448
WIRE 384 512 384 496
WIRE -208 528 -208 432
WIRE -48 528 -48 448
WIRE -48 528 -208 528
WIRE -2608 544 -2608 448
WIRE -2080 544 -2080 288
WIRE -2080 544 -2608 544
WIRE -3712 560 -3712 528
WIRE -48 576 -48 528
WIRE -2864 624 -2864 576
FLAG 112 240 0
FLAG -128 0 0
FLAG -128 -144 Vsupply
FLAG 112 112 Vsupply
FLAG -32 0 0
FLAG -480 192 Vcontrol
FLAG -48 576 0
FLAG -2864 -16 Vsupply
FLAG 384 512 0
FLAG -528 -176 Vcontrol
FLAG -528 16 0
FLAG 384 -128 Vsupply
FLAG -2864 624 0
FLAG -2128 416 0
FLAG -3344 416 0
FLAG -3344 256 Vocc
FLAG -2992 208 Vocc
FLAG -1968 -96 Vsupply
FLAG -1616 144 0
FLAG -1248 -64 Vpump
FLAG -1968 160 PWM
FLAG -3712 560 0
FLAG -3712 400 PWM
SYMBOL Opamps\\UniversalOpamp2 112 176 R0
SYMATTR InstName U1
SYMBOL voltage -128 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage -32 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res 288 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 368 384 R0
SYMATTR InstName R2
SYMATTR Value 2
SYMBOL res 368 -96 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL nmos 336 96 R0
SYMATTR InstName M1
SYMBOL res 288 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res -64 352 R0
SYMATTR InstName R5
SYMATTR Value 100
SYMBOL res -320 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL voltage -528 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 5 0 0 0 1m 2m 0)
SYMBOL cap -192 432 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C1
SYMATTR Value 100µ
SYMBOL cap 320 272 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL Misc\\NE555 -2288 256 R180
SYMATTR InstName U2
SYMBOL res -2880 64 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL res -2880 320 R0
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL cap -2848 576 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C7
SYMATTR Value 1n5
SYMBOL voltage -3344 288 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 10
SYMBOL schottky -1920 -48 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -1744 64 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C8
SYMATTR Value 10µ
SYMBOL cap -1600 64 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C9
SYMATTR Value 10µ
SYMBOL cap -1456 64 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C10
SYMATTR Value 10µ
SYMBOL cap -1328 64 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C11
SYMATTR Value 100µ
SYMBOL schottky -1728 -48 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1584 -48 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1440 -48 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D6
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage -3712 432 R0
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 5 1
SYMATTR InstName V5
SYMATTR Value PULSE(0 5 0 {t_edge} {t_edge} {(duty/f)-t_edge} {1/f})
TEXT -1960 384 Left 2 !;dc V4 0 12 0.1
TEXT -1960 488 Left 2 !;step param duty 0.0 1.0 0.01
TEXT -1960 320 Left 2 !;.op
TEXT -1960 440 Left 2 !.tran 0 1 0 0.01
TEXT -3648 600 Left 2 !.param f=40k t_edge=1u duty=0.8
