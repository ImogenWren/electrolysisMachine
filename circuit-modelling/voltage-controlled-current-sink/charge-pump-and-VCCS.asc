Version 4
SHEET 1 880 1044
WIRE -4400 -1136 -4400 -1184
WIRE -4048 -1136 -4400 -1136
WIRE -3664 -1136 -4048 -1136
WIRE -4400 -1088 -4400 -1136
WIRE -4032 -1040 -4064 -1040
WIRE -4064 -1008 -4064 -1040
WIRE -4064 -1008 -4256 -1008
WIRE -4032 -1008 -4032 -1040
WIRE -3936 -1008 -4032 -1008
WIRE -3664 -1008 -3664 -1136
WIRE -3664 -1008 -3712 -1008
WIRE -4384 -976 -4416 -976
WIRE -4416 -960 -4416 -976
WIRE -4416 -960 -4528 -960
WIRE -4384 -960 -4384 -976
WIRE -4256 -960 -4256 -1008
WIRE -4256 -960 -4384 -960
WIRE -4048 -960 -4048 -1136
WIRE -4048 -960 -4064 -960
WIRE -3936 -944 -4144 -944
WIRE -4064 -928 -4064 -960
WIRE -4048 -928 -4064 -928
WIRE -2144 -928 -2144 -960
WIRE -2016 -928 -2144 -928
WIRE -1824 -928 -1936 -928
WIRE -1536 -928 -1824 -928
WIRE -1392 -928 -1536 -928
WIRE -1216 -928 -1328 -928
WIRE -4144 -896 -4144 -944
WIRE -4144 -896 -4160 -896
WIRE -4048 -896 -4048 -928
WIRE -4048 -896 -4064 -896
WIRE -4400 -880 -4400 -1008
WIRE -3936 -880 -4400 -880
WIRE -3616 -880 -3712 -880
WIRE -1536 -880 -1536 -928
WIRE -4160 -864 -4160 -896
WIRE -4144 -864 -4160 -864
WIRE -4064 -864 -4064 -896
WIRE -4048 -864 -4064 -864
WIRE -1216 -864 -1216 -928
WIRE -4400 -832 -4400 -880
WIRE -4048 -816 -4048 -864
WIRE -3936 -816 -4048 -816
WIRE -3664 -816 -3712 -816
WIRE -1824 -784 -1824 -928
WIRE -1680 -784 -1824 -784
WIRE -1824 -768 -1824 -784
WIRE -3664 -752 -3664 -816
WIRE -1680 -736 -1680 -784
WIRE -1536 -736 -1536 -800
WIRE -4400 -720 -4400 -752
WIRE -4144 -720 -4144 -864
WIRE -4144 -720 -4400 -720
WIRE -1872 -688 -1920 -688
WIRE -4400 -656 -4400 -720
WIRE -1824 -656 -1824 -672
WIRE -1680 -656 -1680 -672
WIRE -1680 -656 -1824 -656
WIRE -1536 -656 -1536 -672
WIRE -1536 -656 -1680 -656
WIRE -1216 -656 -1216 -800
WIRE -1216 -656 -1536 -656
WIRE -1824 -640 -1824 -656
WIRE -4144 -624 -4144 -720
WIRE -3616 -624 -3616 -880
WIRE -3616 -624 -4144 -624
WIRE -4400 -544 -4400 -592
WIRE -4272 -512 -4272 -560
WIRE -4272 -400 -4272 -432
WIRE -2880 -176 -2880 -192
WIRE -2736 -176 -2880 -176
WIRE -2336 -176 -2736 -176
WIRE -2880 -144 -2880 -176
WIRE -2736 -144 -2736 -176
WIRE -224 -112 -224 -192
WIRE 176 -112 176 -160
WIRE 272 -112 272 -160
WIRE 688 -96 688 -144
WIRE -2336 -80 -2336 -176
WIRE -2736 -32 -2736 -64
WIRE -2400 -32 -2736 -32
WIRE 176 -16 176 -32
WIRE 272 -16 272 -32
WIRE -2736 0 -2736 -32
WIRE -224 0 -224 -32
WIRE -1904 16 -1904 -16
WIRE -1856 16 -1904 16
WIRE -1696 16 -1792 16
WIRE -1664 16 -1696 16
WIRE -1552 16 -1552 -64
WIRE -1552 16 -1600 16
WIRE -1520 16 -1552 16
WIRE -1408 16 -1456 16
WIRE -1376 16 -1408 16
WIRE -1280 16 -1280 -64
WIRE -1280 16 -1312 16
WIRE -1216 16 -1280 16
WIRE -1104 16 -1152 16
WIRE -1056 16 -1104 16
WIRE -960 16 -960 -64
WIRE -960 16 -992 16
WIRE -912 16 -960 16
WIRE -816 16 -816 0
WIRE -816 16 -848 16
WIRE -784 16 -816 16
WIRE -672 16 -720 16
WIRE -560 16 -560 -80
WIRE -560 16 -672 16
WIRE -2880 48 -2880 -64
WIRE -2880 48 -3040 48
WIRE -2800 48 -2880 48
WIRE -1696 80 -1696 16
WIRE -1552 80 -1552 16
WIRE -1408 80 -1408 16
WIRE -1280 80 -1280 16
WIRE -1104 80 -1104 16
WIRE -960 80 -960 16
WIRE -816 80 -816 16
WIRE -560 80 -560 16
WIRE 688 80 688 -16
WIRE -672 96 -672 16
WIRE -2336 128 -2336 16
WIRE -2080 128 -2336 128
WIRE 416 128 416 96
WIRE -2736 144 -2736 96
WIRE -2640 144 -2736 144
WIRE 384 144 304 144
WIRE -2880 160 -2880 48
WIRE 496 160 448 160
WIRE 608 160 576 160
WIRE 640 160 608 160
WIRE -1392 176 -1424 176
WIRE -1088 176 -1120 176
WIRE -800 176 -832 176
WIRE -112 176 -176 176
WIRE 96 176 -32 176
WIRE 256 176 96 176
WIRE 384 176 256 176
WIRE -2336 192 -2336 128
WIRE -1552 192 -1552 144
WIRE -1424 192 -1424 176
WIRE -1424 192 -1552 192
WIRE -1392 192 -1392 176
WIRE -1280 192 -1280 144
WIRE -1280 192 -1392 192
WIRE -1120 192 -1120 176
WIRE -1120 192 -1280 192
WIRE -1088 192 -1088 176
WIRE -960 192 -960 144
WIRE -960 192 -1088 192
WIRE -832 192 -832 176
WIRE -832 192 -960 192
WIRE -800 192 -800 176
WIRE -672 192 -672 160
WIRE -672 192 -800 192
WIRE -560 192 -560 160
WIRE -560 192 -672 192
WIRE 608 192 608 160
WIRE -2736 208 -2736 144
WIRE -2640 208 -2640 144
WIRE -1552 224 -1552 192
WIRE 416 224 416 192
WIRE -2736 304 -2736 288
WIRE -2640 304 -2640 272
WIRE -2640 304 -2736 304
WIRE -2336 304 -2336 272
WIRE -2336 304 -2640 304
WIRE -2080 304 -2080 128
WIRE -1696 304 -1696 144
WIRE -1696 304 -2080 304
WIRE -1408 304 -1408 144
WIRE -1408 304 -1696 304
WIRE -1104 304 -1104 144
WIRE -1104 304 -1408 304
WIRE -816 304 -816 144
WIRE -816 304 -1104 304
WIRE 304 304 304 144
WIRE 496 304 304 304
WIRE 688 304 688 176
WIRE 688 304 576 304
WIRE -2880 336 -2880 240
WIRE -2736 336 -2736 304
WIRE 96 352 96 176
WIRE 256 352 256 176
WIRE 688 384 688 304
WIRE 608 480 608 256
WIRE 608 480 592 480
WIRE 688 480 688 464
WIRE 688 480 608 480
WIRE -1392 496 -1392 448
WIRE 688 496 688 480
WIRE 96 512 96 416
WIRE 256 512 256 432
WIRE 256 512 96 512
WIRE 256 560 256 512
WIRE -1392 608 -1392 576
FLAG 416 224 0
FLAG 176 -16 0
FLAG 176 -160 Vsupply
FLAG 416 96 Vsupply
FLAG 272 -16 0
FLAG -176 176 Vcontrol
FLAG 256 560 0
FLAG -4400 -1184 Vsupply
FLAG 688 496 0
FLAG -224 -192 Vcontrol
FLAG -224 0 0
FLAG 688 -144 Vsupply
FLAG -4400 -544 0
FLAG -3664 -752 0
FLAG -4272 -400 0
FLAG -4272 -560 Vocc
FLAG -4528 -960 Vocc
FLAG -1904 -16 Vsupply
FLAG -1552 224 0
FLAG -560 -80 Vpump
FLAG -1920 -800 PWM
FLAG -1392 608 0
FLAG -1392 448 PWM
FLAG -1552 -64 Vpump0
FLAG -1280 -64 Vpump1
FLAG -960 -64 Vpump2
FLAG -2880 -192 Vsupply
FLAG -2736 336 0
FLAG -2880 336 0
FLAG -1824 -640 0
FLAG -2144 -960 Vsupply
FLAG -3040 48 PWM
SYMBOL Opamps\\UniversalOpamp2 416 160 R0
SYMATTR InstName U1
SYMBOL voltage 176 -128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage 272 -128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res 592 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 672 368 R0
SYMATTR InstName R2
SYMATTR Value 2
SYMBOL res 672 -112 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL nmos 640 80 R0
SYMATTR InstName M1
SYMBOL res 592 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res 240 336 R0
SYMATTR InstName R5
SYMATTR Value 100
SYMBOL res -16 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL voltage -224 -128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 5 0 0 0 1m 2m 0)
SYMBOL cap 112 416 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C1
SYMATTR Value 100µ
SYMBOL cap 624 256 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL Misc\\NE555 -3824 -912 R180
SYMATTR InstName U2
SYMBOL res -4416 -1104 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL res -4416 -848 R0
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL cap -4384 -592 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C7
SYMATTR Value 1n5
SYMBOL voltage -4272 -528 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 10
SYMBOL schottky -1856 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -1680 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C8
SYMATTR Value 10µ
SYMBOL cap -1536 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C9
SYMATTR Value 10µ
SYMBOL cap -1392 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C10
SYMATTR Value 10µ
SYMBOL schottky -1664 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1520 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1376 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D6
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage -1392 480 R0
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 5 1
SYMATTR InstName V5
SYMATTR Value PULSE(0 5 0 {t_edge} {t_edge} {(duty/f)-t_edge} {1/f} 20k)
SYMBOL cap -656 160 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C3
SYMATTR Value 100µ
SYMBOL cap -1264 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C4
SYMATTR Value 10µ
SYMBOL schottky -1216 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1056 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -1088 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C5
SYMATTR Value 10µ
SYMBOL res -544 176 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL schottky -912 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D7
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -784 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D8
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -944 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C6
SYMATTR Value 10µ
SYMBOL cap -800 144 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C11
SYMATTR Value 10µ
SYMBOL npn -2800 0 R0
SYMATTR InstName Q1
SYMBOL res -2864 256 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R13
SYMATTR Value 47k
SYMBOL res -2864 -48 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res -2720 304 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R12
SYMATTR Value 1.5k
SYMBOL res -2720 -48 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL cap -2624 272 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C12
SYMATTR Value 10µ
SYMBOL nmos -1872 -768 R0
SYMATTR InstName M2
SYMBOL ind -2032 -912 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 100µ
SYMBOL cap -1520 -672 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C13
SYMATTR Value 100p
SYMBOL res -1552 -896 R0
SYMATTR InstName R11
SYMATTR Value 2.2k
SYMBOL schottky -1392 -912 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D9
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1664 -672 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D10
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL npn -2400 -80 R0
SYMATTR InstName Q2
SYMBOL res -2320 288 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R15
SYMATTR Value 500
TEXT -1888 504 Left 2 !;dc V4 0 12 0.1
TEXT -1888 608 Left 2 !;step param duty 0.0 1.0 0.01
TEXT -1888 440 Left 2 !;.op
TEXT -1888 560 Left 2 !.tran 0 1 0 0.01
TEXT -1328 648 Left 2 !.param f=40k t_edge=1u duty=0.5
